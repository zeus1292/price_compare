<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retail Right - Smart Product Price Comparison</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõçÔ∏è</text></svg>">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="javascript:void(0)" class="logo" onclick="goHome()">
                <span class="logo-icon">üõçÔ∏è</span>
                <span class="logo-text">Retail Right</span>
            </a>
            <div class="header-actions" id="header-actions">
                <!-- Auth buttons populated by JS -->
                <button class="auth-btn" id="login-btn" onclick="showAuthModal('login')">Log In</button>
                <button class="auth-btn primary" id="signup-btn" onclick="showAuthModal('signup')">Sign Up</button>
            </div>
            <div class="user-menu hidden" id="user-menu">
                <span class="user-name" id="user-name"></span>
                <button class="auth-btn" onclick="logout()">Log Out</button>
            </div>
        </div>
    </header>

    <div class="app-container">
        <main>
            <!-- Hero Section -->
            <section class="hero-section">
                <div class="hero-content">
                    <h1 class="hero-title">
                        <span class="hero-title-line">Find the Best Prices</span>
                        <span class="hero-title-gradient">Across the Web</span>
                    </h1>
                    <p class="hero-subtitle">Compare prices from hundreds of retailers instantly. Search by text, URL, or image.</p>
                </div>
                <div class="hero-features">
                    <div class="hero-feature">
                        <span class="hero-feature-icon">üîç</span>
                        <span class="hero-feature-text">Smart Search</span>
                    </div>
                    <div class="hero-feature">
                        <span class="hero-feature-icon">üè∑Ô∏è</span>
                        <span class="hero-feature-text">Price Comparison</span>
                    </div>
                    <div class="hero-feature">
                        <span class="hero-feature-icon">üì∏</span>
                        <span class="hero-feature-text">Image Search</span>
                    </div>
                    <div class="hero-feature">
                        <span class="hero-feature-icon">‚ö°</span>
                        <span class="hero-feature-text">Real-time Results</span>
                    </div>
                </div>
            </section>

            <!-- Search Module -->
            <section class="search-module" id="search-module">
                <div class="search-body" id="search-body">
                    <form id="search-form" class="unified-search-form">
                        <!-- Main Input Area -->
                        <div class="input-row">
                            <div class="search-input-wrapper">
                                <input
                                    type="text"
                                    id="search-input"
                                    class="search-input"
                                    placeholder="Search for any product..."
                                    autocomplete="off"
                                >
                                <button type="button" class="camera-btn" id="camera-btn" title="Search by image">
                                    üì∑
                                </button>
                                <input type="file" id="image-input" accept="image/*" class="hidden">
                            </div>
                            <button type="submit" class="search-btn" id="search-btn">
                                Search
                            </button>
                        </div>

                        <!-- Image Drop Zone (hidden by default, shown when camera clicked) -->
                        <div class="image-drop-zone" id="image-drop-zone">
                            <div class="drop-zone-content" id="drop-zone-content">
                                <span class="drop-icon">üì∑</span>
                                <span class="drop-text">Drop an image here or click to upload</span>
                            </div>
                            <div class="image-preview-container hidden" id="image-preview-container">
                                <img id="image-preview" src="" alt="Preview">
                                <button type="button" class="remove-image-btn" id="remove-image-btn" title="Remove image">‚úï</button>
                            </div>
                        </div>

                        <!-- Search Options -->
                        <div class="search-options">
                            <label class="search-option">
                                <input type="checkbox" id="enable-live-search" checked>
                                <span>Live web search</span>
                            </label>
                            <label class="search-option">
                                <span>Min confidence:</span>
                                <input type="range" id="confidence-threshold" min="0" max="100" value="70">
                                <span class="threshold-value" id="threshold-value">70%</span>
                            </label>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Recent Searches (for logged-in users) -->
            <section id="recent-searches-section" class="recent-searches-section hidden">
                <div class="section-header">
                    <h3 class="section-title">Recent Searches</h3>
                    <button class="clear-history-btn" onclick="clearSearchHistory()">Clear</button>
                </div>
                <div class="recent-searches-list" id="recent-searches-list">
                    <!-- Recent searches populated by JS -->
                </div>
            </section>

            <!-- Popular Searches -->
            <section id="popular-section" class="popular-section">
                <h3 class="section-title">
                    <span class="section-title-icon">üî•</span>
                    Trending Searches
                </h3>
                <p class="section-subtitle">Most searched products in the last 7 days</p>
                <div class="popular-searches" id="popular-searches">
                    <!-- Populated by JavaScript -->
                    <div class="popular-loading">Loading trending searches...</div>
                </div>
            </section>

            <!-- Loading Section -->
            <section id="loading-section" class="loading-section hidden">
                <div class="loading-spinner"></div>
                <h3 class="loading-title">Finding the best matches...</h3>
                <p class="loading-status" id="loading-status">Analyzing your query</p>
                <div class="loading-steps">
                    <div class="loading-step" id="step-extract">
                        <span class="step-indicator">1</span>
                        <span>Analyzing</span>
                    </div>
                    <div class="loading-step" id="step-search">
                        <span class="step-indicator">2</span>
                        <span>Searching</span>
                    </div>
                    <div class="loading-step" id="step-rank">
                        <span class="step-indicator">3</span>
                        <span>Ranking</span>
                    </div>
                </div>
                <p class="loading-time" id="loading-time"></p>
            </section>

            <!-- Error Section -->
            <section id="error-section" class="error-section hidden">
                <span class="error-icon">‚ö†Ô∏è</span>
                <p class="error-message" id="error-message"></p>
            </section>

            <!-- Results Section -->
            <section id="results-section" class="results-section hidden">
                <div class="results-header">
                    <div class="results-title-row">
                        <button class="back-btn" onclick="goHome()" title="Back to Home">
                            <span class="back-icon">‚Üê</span>
                            <span class="back-text">Home</span>
                        </button>
                        <h2 class="results-title">
                            <span id="results-title-text">Matches Found</span>
                        </h2>
                    </div>
                    <div class="results-controls">
                        <span class="results-meta-item" id="result-count">0 results</span>
                        <div class="sort-control">
                            <label for="sort-by">Sort by:</label>
                            <select id="sort-by" class="sort-select" onchange="handleSortChange()">
                                <option value="relevance">Relevance</option>
                                <option value="price_low_high">Price: Low to High</option>
                                <option value="price_high_low">Price: High to Low</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Results Grid -->
                <div class="results-grid" id="results-grid">
                    <!-- Product cards populated by JavaScript -->
                </div>
            </section>

        </main>

        <!-- Stats Section -->
        <section class="stats-section" id="stats-section">
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-number" data-target="50000">50K+</span>
                    <span class="stat-label">Products Indexed</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" data-target="100">100+</span>
                    <span class="stat-label">Retailers</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" data-target="95">95%</span>
                    <span class="stat-label">Match Accuracy</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">&lt;2s</span>
                    <span class="stat-label">Avg Response Time</span>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section class="how-it-works-section">
            <h2 class="section-heading">How It Works</h2>
            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <div class="step-icon">üîé</div>
                    <h3 class="step-title">Search</h3>
                    <p class="step-desc">Enter a product name, paste a URL, or upload an image</p>
                </div>
                <div class="step-card">
                    <div class="step-number">2</div>
                    <div class="step-icon">ü§ñ</div>
                    <h3 class="step-title">AI Analysis</h3>
                    <p class="step-desc">Our AI agents analyze and match your query across databases</p>
                </div>
                <div class="step-card">
                    <div class="step-number">3</div>
                    <div class="step-icon">üí∞</div>
                    <h3 class="step-title">Compare</h3>
                    <p class="step-desc">See prices from multiple retailers and find the best deal</p>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-brand">
                    <span class="footer-logo">üõçÔ∏è</span>
                    <span class="footer-name">Retail Right</span>
                </div>
                <p class="footer-text">Powered by multi-agent AI with LangGraph</p>
                <div class="footer-links">
                    <a href="/docs" target="_blank" class="footer-link">API Docs</a>
                    <a href="/api/v1/search/metrics" target="_blank" class="footer-link">Metrics</a>
                    <a href="/health/detailed" target="_blank" class="footer-link">Status</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2026 Retail Right. Built with FastAPI, LangChain & ChromaDB.</p>
            </div>
        </footer>
    </div>

    <!-- Floating Background Elements -->
    <div class="floating-elements">
        <div class="floating-shape shape-1"></div>
        <div class="floating-shape shape-2"></div>
        <div class="floating-shape shape-3"></div>
        <div class="floating-shape shape-4"></div>
        <div class="floating-shape shape-5"></div>
    </div>

    <!-- Auth Modal -->
    <div class="modal-overlay hidden" id="auth-modal">
        <div class="modal">
            <button class="modal-close" onclick="hideAuthModal()">&times;</button>
            <div class="modal-header">
                <h2 class="modal-title" id="auth-modal-title">Log In</h2>
            </div>
            <div class="modal-body">
                <form id="auth-form" onsubmit="handleAuthSubmit(event)">
                    <div class="form-group hidden" id="name-group">
                        <label for="auth-name">Name</label>
                        <input type="text" id="auth-name" class="form-input" placeholder="Your name">
                    </div>
                    <div class="form-group">
                        <label for="auth-email">Email</label>
                        <input type="email" id="auth-email" class="form-input" placeholder="you@example.com" required>
                    </div>
                    <div class="form-group">
                        <label for="auth-password">Password</label>
                        <input type="password" id="auth-password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6">
                    </div>
                    <div class="auth-error hidden" id="auth-error"></div>
                    <button type="submit" class="auth-submit-btn" id="auth-submit-btn">Log In</button>
                </form>
                <div class="auth-switch">
                    <span id="auth-switch-text">Don't have an account?</span>
                    <button type="button" class="auth-switch-btn" id="auth-switch-btn" onclick="toggleAuthMode()">Sign Up</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
